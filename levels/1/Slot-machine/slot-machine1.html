<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lucky Spin</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

  <style>
    * {
      padding: 0;
      margin: 0;
      box-sizing: border-box;
    }
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      min-height: 100vh;
      background: white;
      font-family: 'Open Sans', sans-serif;
    }
    .game-container {
      background-color: white;
      padding: 40px 80px;
      border-radius: 15px;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 20px;
    }
    .container {
      height: 350px;
      width: 350px;
      background: url('tablero.png') no-repeat center center/cover;
      position: relative;
      border-radius: 50%;
      overflow: hidden;
      transition: 3s all;
      margin-bottom: 20px;
    }
    #spin {
      height: 60px;
      width: 120px;
      font-size: 30px;
      font-weight: 1000;
      border: none;
      cursor: pointer;
      border-radius: 5px;
      background: transparent;
    }
    .stoper {
      height: 50px;
      width: 28.78px;
      background: url('Indicador.png') no-repeat center center/cover;
      position: absolute;
      top: 28%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
    }
    .machine {
      position: relative;
      width: 500px;
      height: 375px;
      background: url('Machine3.png') no-repeat center;
      background-size: cover;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }
    .lever {
      position: absolute;
      right: -50px;
      top: 70px;
      width: 110px;
      height: 165px;
      background: url('Palanca.png') no-repeat center;
      background-size: contain;
      transform-origin: bottom left;
      transition: transform 0.2s ease-out;
    }
    .display {
      position: absolute;
      top: 60%;
      transform: translateY(-50%);
      font-size: 6rem;
      font-weight: bold;
      text-align: center;
      min-width: 130px;
      padding: 12px;
      border-radius: 12px;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #0C0070;
      letter-spacing: 28px;
      margin-right: -25px;
    }
	.btnCC2 {
	  background-color: #2196f3;
	  color: white;
	  border: none;
	  padding: 8px 40px;
	  border-radius: 8px;
	  cursor: pointer;
	  font-size: 20px;
	  transition: background-color 0.3s ease;
	  margin-top: 0px;
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  width: 30%;
	}
	.btnCC2:hover {
	  background-color: #1976d2;
	}

	  
.thermometer-wrapper {
  position: fixed;
  left: 5px;
  top: 50%;
  transform: translateY(-50%);
  z-index: 1000;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 15px;
}
.thermometer {
  width: 16px;
  height: 500px;
  background-color: #e6f0ff;
  border-radius: 10px;
  border: 2px solid #e6f0ff;
  position: relative;
  overflow: hidden;
}

.fill {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 0%;
  background: #2196f3;
  border-radius: 15px;
  transition: height 0.3s ease;
  z-index: 1;
}

#btnIncrease {
  padding: 8px 20px;
  font-size: 16px;
  background-color: #2196f3;;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

#btnIncrease:hover {
  background-color: #1976d2;
}
	  
  </style>
</head>
<body>
  <div class="game-container">
    <div class="machine">
      <div class="lever" id="lever">
        <button id="spin"></button>
        <div class="stoper" style="background-image: url('Indicador.png');"></div>
		<div class="container" style="background-image: url('tablero.png');"></div>
      </div>
      <div class="display" id="display">
		  <img id="slot-image" src="words/CC-01.png" alt="slot image" style="max-height: 62px; margin-right: 26px;">
		</div>
    </div>
  </div>
	
	<div style="margin-top: 20px;">
	  <button id="playSound" class="btnCC2">
		<i class="fas fa-volume-up"></i>
	  </button>
	</div>
	
	<audio id="audioLever" src="audios/palanca.mp3" preload="auto"></audio>
	<audio id="audioSpin" src="audios/ruleta.mp3" preload="auto"></audio>
	<audio id="audioWin" src="audios/win.mp3" preload="auto"></audio>
	<audio id="pingSound" src="audios/point.mp3" preload="auto"></audio>
    <audio id="audioComplete" src="audios/Complete.wav" preload="auto"></audio>
 	<audio id="audioConfetti" src="audios/confetti.mp3" preload="auto"></audio>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">

	<div class="thermometer-wrapper">
	  <div class="thermometer">
		<div class="fill" id="thermoFill"></div>
	  </div>
	  <button id="btnIncrease"><span class="material-icons-round">rocket_launch</span></button>
	</div>
	
	
	
  <script>
  const lever = document.getElementById('lever');
  const display = document.getElementById('display');
  const container = document.querySelector(".container");
  const spinButton = document.getElementById("spin");
  const slotImage = document.getElementById('slot-image');
  const audioLever = document.getElementById('audioLever');
  const audioSpin = document.getElementById('audioSpin');
  const audioWin = document.getElementById('audioWin');
  const playSoundBtn = document.getElementById('playSound');

  let isDragging = false;
  let startY = 0;

  // ðŸ”„ Sistema de imÃ¡genes sin repeticiÃ³n
  let imagePool = [];
  let currentIndex = 0;
  let lastImageCode = '01';

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function initializeImagePool() {
  imagePool = [];
  for (let i = 1; i <= 12; i++) {
    const padded = i.toString().padStart(2, '0');
    imagePool.push(`words/CC-${padded}.png`);
  }
  shuffle(imagePool);
  currentIndex = 0;
}

function getNextImagePath() {
  if (currentIndex >= imagePool.length) {
    initializeImagePool(); // ðŸ”„ cuando se usaron todas, se vuelve a barajar
  }
  const path = imagePool[currentIndex++];
  const match = path.match(/CC-(\d+)\.png$/);
  lastImageCode = match ? match[1] : '01';
  return path;
}

  // ðŸŽ° AnimaciÃ³n con sonido
function animateImage() {
  let counter = 0;

  audioSpin.currentTime = 0;
  audioSpin.play();

  let interval = setInterval(() => {
    slotImage.src = getNextImagePath(); // ðŸ”„ mostrar imÃ¡genes sin repetir
    counter++;
    if (counter > 30) {
      clearInterval(interval);
      audioSpin.pause();

      const finalImage = getNextImagePath(); // âœ… resultado final tambiÃ©n Ãºnico
      slotImage.src = finalImage;

      audioWin.currentTime = 0;
      audioWin.play();
    }
  }, 100);
}


  // ðŸŽ® Palanca
  lever.addEventListener('mousedown', (e) => {
    isDragging = true;
    startY = e.clientY;
  });

  document.addEventListener('mousemove', (e) => {
    if (isDragging) {
      let deltaY = e.clientY - startY;
      let rotation = Math.min(Math.max(deltaY, 0), 20);
      lever.style.transform = `rotateX(${rotation}deg) rotateZ(40deg)`;
    }
  });

  document.addEventListener('mouseup', () => {
    if (isDragging) {
      isDragging = false;
      lever.style.transform = 'rotateX(0deg) rotateZ(0deg)';
      audioLever.currentTime = 0;
      audioLever.play();
      animateImage();
    }
  });

  // ðŸŽ¯ BotÃ³n para girar (hover)
  spinButton.addEventListener("mouseover", () => {
    const spinDegrees = 360 * 3 + Math.floor(Math.random() * 360);
    container.style.transition = "transform 3s ease-out";
    container.style.transform = `rotate(${spinDegrees}deg)`;
  });

  // ðŸ”Š BotÃ³n de sonido asociado a la imagen
  playSoundBtn.addEventListener('click', () => {
    const soundPath = `words/CC-${lastImageCode}.mp3`;
    const sound = new Audio(soundPath);
    sound.play();
  });

  // ðŸŸ¢ Inicializa las imÃ¡genes al cargar
  initializeImagePool();
	function getRandomImageForAnimation() {
  const n = Math.floor(Math.random() * 12) + 1;
  const padded = n.toString().padStart(2, '0');
  return `words/CC-${padded}.png`;
}

function animateImage() {
  let counter = 0;

  audioSpin.currentTime = 0;
  audioSpin.play();

  let interval = setInterval(() => {
    slotImage.src = getRandomImageForAnimation(); // ðŸ‘ˆ solo visual
    counter++;
    if (counter > 30) {
      clearInterval(interval);
      audioSpin.pause();

      const finalImage = getNextImagePath(); // ðŸ‘ˆ ahora sÃ­ usamos 1 Ãºnica imagen
      slotImage.src = finalImage;

      audioWin.currentTime = 0;
      audioWin.play();
    }
  }, 100);
}

	  
	  
const btnIncrease = document.getElementById('btnIncrease');
const thermoFill = document.getElementById('thermoFill');
const pingSound = document.getElementById('pingSound');

let currentLevel = 0;
const maxLevel = 5;
const thermometerHeight = 500; // â† asegÃºrate que coincida con tu CSS

let completedOnce = false; // evita duplicar celebraciÃ³n

btnIncrease.addEventListener('click', () => {
  if (currentLevel < maxLevel) {
    currentLevel++;
    const percentage = (currentLevel / maxLevel) * 100;

    thermoFill.style.height = `${percentage}%`;

    // Sonido por cada incremento
    pingSound.currentTime = 0;
    pingSound.play();

    // Â¿LlegÃ³ al mÃ¡ximo?
    if (currentLevel === maxLevel && !completedOnce) {
      completedOnce = true;

      // Audio de completado
      const audioComplete = document.getElementById('audioComplete');
      audioComplete.currentTime = 0;
      audioComplete.play();

	// Audio de confetti extra
	const audioConfetti = document.getElementById('audioConfetti');
	audioConfetti.currentTime = 0;
	audioConfetti.play();

		
      // Confetti ðŸŽ‰
      fireConfettiCelebration();
    }
  }
});
	  
 function resetThermo(){
  currentLevel = 0;
  completedOnce = false;
  thermoFill.style.height = '0%';
}
	  
	  
	  
function fireConfettiCelebration() {
  // rÃ¡faga inicial
  confetti({
    particleCount: 120,
    spread: 70,
    origin: { y: 0.7 }
  });

  // lluvia corta extra (opcional)
  const duration = 1500; // ms
  const end = Date.now() + duration;
  (function frame() {
    confetti({
      particleCount: 12,
      angle: 60,
      spread: 55,
      origin: { x: 0 }
    });
    confetti({
      particleCount: 12,
      angle: 120,
      spread: 55,
      origin: { x: 1 }
    });
    if (Date.now() < end) requestAnimationFrame(frame);
  })();
}

</script>
</body>
</html>
